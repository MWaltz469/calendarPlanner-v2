/*
 * TripWeek â€” Minimal CSS Layer
 *
 * Tailwind CDN handles all component styling via utility classes.
 * This file contains only what Tailwind CDN cannot do:
 * - CSS custom properties (design tokens for both themes)
 * - Global resets and base styles
 * - Theme transition system
 * - Loading spinner (pseudo-element + keyframe)
 * - Toast animations (keyframes)
 * - Pointer-aware media queries
 * - Step panel hidden override
 * - Reduced motion preference
 */

/* ===== Design Tokens ===== */

:root {
  /* Core palette */
  --bg: #f4fbff;
  --surface: #ffffff;
  --surface-muted: #f7fbfc;
  --border: #d8e2e8;
  --ink: #0f1f2e;
  --ink-soft: #486276;
  --accent: #0f766e;
  --accent-strong: #115e59;

  /* Semantic */
  --available: #16a34a;
  --available-soft: #dcfce7;
  --maybe: #f59e0b;
  --maybe-soft: #fef3c7;
  --danger: #dc2626;
  --danger-soft: #fff2f2;
  --ok-bg: #ecfdf5;
  --ok-border: #bbf7d0;
  --ok-text: #166534;
  --warn-bg: #fffbeb;
  --warn-border: #fde68a;
  --warn-text: #92400e;
  --info-bg: #eff6ff;
  --info-border: #bfdbfe;
  --info-text: #1e40af;

  /* Accent surface (teal-tinted) */
  --accent-bg: #ecf7f6;
  --accent-border: #b9e4df;
  --accent-text: #145f58;

  /* Neutral status */
  --neutral-bg: #f3f4f6;
  --neutral-border: #d1d5db;
  --neutral-text: #6b7280;

  /* Danger (completing the set) */
  --danger-border: #fecaca;

  /* Radius */
  --radius-lg: 16px;
  --radius-md: 12px;
  --radius-sm: 8px;
  --radius-pill: 999px;

  /* Shadows */
  --shadow-sm: 0 2px 8px rgba(15, 31, 46, 0.05);
  --shadow-md: 0 8px 24px rgba(15, 31, 46, 0.08);
  --shadow-lg: 0 16px 32px rgba(15, 31, 46, 0.12);
  --shadow: var(--shadow-md);

  --theme-transition-ms: 220ms;
  color-scheme: light;
}

:root[data-theme="dark"] {
  --bg: #0d1722;
  --surface: #122130;
  --surface-muted: #162838;
  --border: #2a3f51;
  --ink: #e4eef7;
  --ink-soft: #9bb2c4;
  --accent: #19a7a0;
  --accent-strong: #27c3ba;
  --available: #22c55e;
  --available-soft: #103122;
  --maybe: #f59e0b;
  --maybe-soft: #392d10;
  --danger: #f87171;
  --danger-soft: #3a1f25;
  --ok-bg: #113523;
  --ok-border: #1f8d46;
  --ok-text: #4ade80;
  --warn-bg: #3d2d12;
  --warn-border: #8f651a;
  --warn-text: #fbbf24;
  --info-bg: #172554;
  --info-border: #1e3a5f;
  --info-text: #93c5fd;

  --accent-bg: #0f2b2a;
  --accent-border: #25766f;
  --accent-text: #5eead4;

  --neutral-bg: #1f2f3f;
  --neutral-border: #425b71;
  --neutral-text: #9ca3af;

  --danger-border: #7b303c;
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.2);
  --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.3);
  --shadow-lg: 0 16px 32px rgba(0, 0, 0, 0.4);
  --shadow: var(--shadow-md);
  color-scheme: dark;
}

/* ===== Global Resets ===== */

* {
  box-sizing: border-box;
}

a, button, select, input, [role="button"] {
  touch-action: manipulation;
}

html,
body {
  margin: 0;
  min-height: 100%;
  color: var(--ink);
  font-family: "Manrope", sans-serif;
  background: var(--bg);
}

body {
  padding: 0.6rem 0.8rem 1.1rem;
}

/* ===== Theme Transitions ===== */

:root.theme-ready body,
:root.theme-ready .card {
  transition:
    background-color var(--theme-transition-ms) ease,
    color var(--theme-transition-ms) ease,
    border-color var(--theme-transition-ms) ease,
    box-shadow var(--theme-transition-ms) ease;
}

/* ===== Layout Shells ===== */

.app-shell {
  width: min(1040px, 100%);
  margin: 0 auto;
  display: grid;
  gap: 0.9rem;
}

.card {
  border-radius: var(--radius-lg);
  border: none;
  background: var(--surface);
  box-shadow: var(--shadow-md);
}

:root[data-theme="dark"] body {
  background: var(--bg);
}

:root[data-theme="dark"] .card {
  background: var(--surface);
}

/* ===== Step Panel (hidden override required) ===== */

.step-panel {
  width: min(920px, 100%);
  margin: 0 auto;
  display: grid;
  gap: 0.8rem;
}

.step-panel[hidden] {
  display: none;
}

/* ===== Selection Overlay (sticky + backdrop) ===== */

.selection-overlay {
  position: sticky;
  top: 0.5rem;
  z-index: 12;
  border: none;
  border-radius: var(--radius-md);
  background: var(--surface);
  box-shadow: var(--shadow-lg);
  padding: 0.5rem 0.75rem;
  display: grid;
  gap: 0.5rem;
  backdrop-filter: blur(12px);
}

.selection-overlay[hidden] {
  display: none;
}

/* ===== Loading Spinner ===== */

.loading {
  position: relative;
  pointer-events: none;
}

.loading::after {
  content: "";
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-left: 0.45em;
  border: 2px solid currentColor;
  border-right-color: transparent;
  border-radius: 50%;
  vertical-align: middle;
  animation: btn-spin 0.6s linear infinite;
}

@keyframes btn-spin {
  to {
    transform: rotate(360deg);
  }
}

/* ===== Pointer-aware Help Copy ===== */

.touch-copy { display: inline; }
.pointer-copy { display: none; }
@media (hover: hover) and (pointer: fine) {
  .touch-copy { display: none; }
  .pointer-copy { display: inline; }
}

/* ===== Inline Help (wtf-inline) ===== */

.wtf-inline {
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 0.5rem 0.75rem;
  background: var(--surface-muted);
}

.wtf-inline summary {
  font-size: 0.8125rem;
  font-weight: 700;
  color: var(--ink-soft);
  cursor: pointer;
}

.wtf-inline p {
  margin: 0.5rem 0 0;
  font-size: 0.8125rem;
  color: var(--ink-soft);
  line-height: 1.5;
}

/* ===== Toast Animations ===== */

.toast-animate {
  animation: toast-in 0.28s ease-out, toast-out 0.32s ease-in 2.1s forwards;
}

@keyframes toast-in {
  from {
    opacity: 0;
    transform: translateY(12px) scale(0.96);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes toast-out {
  from {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  to {
    opacity: 0;
    transform: translateY(-8px) scale(0.96);
  }
}

/* ===== Collapsible Arrow Rotation ===== */

details[open] > summary h3::before {
  transform: rotate(90deg);
}

/* ===== Responsive ===== */

@media (min-width: 640px) {
  body {
    padding: 1rem;
    padding-top: 0;
  }

  .selection-overlay {
    top: 0.72rem;
  }
}

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation: none !important;
    transition: none !important;
    scroll-behavior: auto !important;
  }
}
